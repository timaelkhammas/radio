<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>oH radio</title>
  <style>
    html {
      scroll-behavior: smooth;
    }

    body {
      margin: 0;
      font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
      font-weight: 700;
      background-color: rgb(37, 9, 2); /* background color - overridden by JS */
      visibility: hidden; /* Hide until JS applies styles */
    }

    .hero {
      height: 100vh;
      width: 100vw;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    header {
      position: absolute;
      top: 0;
      width: 100%;
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      text-align: center;
      padding: 0.5em;
      font-size: 1.2rem;
      z-index: 2;
    }

    header a {
      text-decoration: none;
      color: inherit; /* Inherit the color */
    }

    header a:hover {
      text-decoration: underline;
    }

    .intro-card {
      width: 100vw;
      height: 100vh;
      object-fit: contain;
      z-index: 0;
    }

    .audio-player {
      position: fixed;
      bottom: 2em;
      left: 1em;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      z-index: 3;
    }

    .custom-button {
      width: 36px;
      height: 36px;
      background-color: transparent;
      border: none;
      padding: 0;
      cursor: pointer;
    }

    .custom-button img {
      width: 100%;
      height: auto;
      display: block;
    }

    audio {
      display: none;
    }

    #progressContainer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%; /* Progress bar spans full width */
      height: 12px; /* Thicker progress bar */
      cursor: pointer;
      z-index: 4;
      background-color: transparent; /* Overridden by JS */
    }

    #progressBar {
      height: 100%;
      width: 0%; /* Initial width */
      position: relative;
    }

    #progressTime {
      position: absolute;
      top: -1.5em; /* adjust as needed */
      right: 0;
      font-size: 0.75rem;
      background-color: transparent;
      color: inherit;
      pointer-events: none;
      /* Prevent text from being included in the progress bar width calculation */
      transform: translateX(-100%); /* Position relative to its container */
      white-space: nowrap; /* Prevent wrapping */
    }


    .archive-section {
      display: flex;
      flex-direction: column;
      gap: 20px;
      font-weight: 500;
      border-top: 2px solid;  /* Border only on top of the row */
      border-bottom: 2px solid; /* Border only on bottom of the row */
      /* Color of borders and text overridden by JS */
    }

    .archive-row {
      display: grid;
      grid-template-columns: repeat(4, 1fr); /* Create 4 equal columns */
      gap: 0px; /* Space between the items */
       /* Background color overridden by JS */
    }

    .archive-item img {
      width: 50px;  /* Small size for the image */
      height: auto; /* Maintain aspect ratio */
      transition: all 0.3s ease-in-out;
    }

    .archive-item {
      padding: 15px;
      border-left: none;
      border-right: none;
      cursor: pointer;
      transition: all 0.3s ease-in-out; /* Smooth transition */
      /* Text color overridden by JS */
    }

    .archive-item.expanded {
      height: auto; /* Let the height expand naturally */
      cursor:default;
    }

    .archive-item h3 {
      margin-top: 0;
      font-size: 1.2rem;
      color: inherit; /* Inherit the color from .archive-item */
    }

    .archive-item p {
      display: none; /* Hide extra information initially */
      font-size: 14px;
      color: inherit; /* Inherit the color from .archive-item */
    }

    .archive-item.expanded p {
      display: block; /* Show extra information when expanded */
      font-weight: 500;
      font-size: 1.1rem;
    }

    .archive-item img {
      transition: all 0.3s ease-in-out;
    }

    .archive-item.expanded img {
      width: 300px; /* Enlarge the image when expanded */
      height: auto;
    }

    .archive-item img.no-filter {
      filter: none !important;
    }

    .archive-item p a {
        color: inherit;
        text-decoration: none;
    }

    .archive-item p a:hover {
        color: inherit; /* Ensure link color matches the surrounding text color */
        text-decoration: none;
    }

    /* --- POPUP STYLES --- */
    .popup-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent dark overlay */
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10; /* High z-index to be on top */
        visibility: hidden; /* Hidden by default */
        opacity: 0;
        transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
    }

    .popup-overlay.visible {
        visibility: visible;
        opacity: 1;
    }

    .popup-content {
        padding: 20px;
        text-align: center;
        max-width: 80%;
        /* Background and text color overridden by JS */
    }

/* Media query for non-desktop sizes */
@media (max-width: 900px) {
      .hero {
        /* Allow content to scroll within the hero on smaller screens if needed */
        overflow-y: auto;
        /* Keep height 100vh on small screens so the hero occupies the full viewport */
        height: 100vh;
      }

      .card-container{
        overflow-y: scroll;
        height: -webkit-fill-available;
        width: 1672px; /* This width looks suspicious, potentially fix needed */
        padding-top: 20px;
      }

      .intro-card {
        width: inherit;
        height: inherit;
        object-fit: cover;
        overflow-y: scroll;
      }

      .archive-row {
        grid-template-columns: 1fr; /* Stack archive items on smaller screens */
      }

      .archive-item {
        padding: 10px; /* Adjust padding for smaller screens */
      }

      .archive-item.expanded img {
        width: 100%; /* Make enlarged image responsive */
        max-width: 300px; /* Prevent it from becoming too large */
        height: auto;
      }
    }

    @media (max-width: 900px) {
      .info-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
</head>
<body>

  <section class="hero">
    <header>
      <div><a href="#archive">archive</a></div>
      <div><a href="https://www.instagram.com/0hradio/" target="_blank">instagram</a></div>
      <div><a href="https://www.mixcloud.com/ohradio3/" target="_blank">mix cloud</a></div>
    </header>
    <div class="card-container">
    <img class="intro-card" src="Images/OhRadio_IntroCard_Compatible.svg" alt="Full Screen SVG" />
  </div>
    <div class="audio-player">
      <button class="custom-button" id="playPauseBtn">
        <img id="buttonIcon" src="images/OhRadio_Play.svg" alt="Play" />
      </button>

      <audio id="audio">
        <source src="audio/AudioTest.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
    </div>

    <div id="progressContainer">
      <div id="progressBar">
        <span id="progressTime">00:00</span>
      </div>
    </div>
  </section>

  <section class="archive-section" id="archive">
    <div class="archive-row">
      <div class="archive-item">
        <h3>
        2.5.2025
        <br>
        ETC. Space
      </h3>
      </div>
      <div class="archive-item">
        <h3>ARAB DRIFT CORE
        <br>
        Tima
      </h3>
        <p>
        <u>Playlist</u>
        <br>
        NMCHI B LIL - Hanaa Ouassim
        <br>
        Leila (200 Shams Remix) - Marcelina & 200 Shams
        <br>
        Malket Gamal El Kowan - Kiss Facility
        <br>
        ISTIQLAL - S DIAMAH
        <br>
        Bingo - El Kontessa
        <br>
        The Key to the Exit - Deena Abdelwahed

        <br><br>

        <u>Bibliography</u>
        <br>
        <sup>1</sup>
        <a href="https://archive.org/details/joyridinginriyad0000mnor" target="_blank">
        Menoret, Pascal. <i>Joyriding in Riyadh: Oil, Urbanism, and Road Revolt</i>, (Cambridge: Cambridge University Press, 2014).
        </a>
        <br>
        <sup>2</sup>
        <a href="https://anthrodendum.org/2017/12/15/whose-streets-protest-and-drifting/" target="_blank">
        Rizvi, Uzma Z. “Whose Streets: Protest and Drifting.” <i>Anthrodendum</i>, 15 Dec. 2017.
        </a>
        <br>
        <sup>3</sup>
        <a href="https://www.routledge.com/Driving-Identities-At-the-Intersection-of-Popular-Music-and-Automotive-Culture/McLeod/p/book/9781032236162" target="_blank">
        McLeod, Ken. <i>Driving Identities: At the Intersection of Popular Music and Automotive Culture.</i> Taylor & Francis, 30 Apr. 2020.
        </a>
        <br>
        <sup>4</sup>
        <a href="https://monoskop.org/images/2/28/Baudrillard_Jean_The_system_of_objects_1996.pdf" target="_blank">
        Baudrillard, Jean. <i>The System of Objects.</i> Translated by James Benedict, Verso, 1996.
        </a>
        </p>
      </div>
      <div class="archive-item">
        <h3>
          Available soon!
      </h3>
      </div>
      <div class="archive-item">
        <img src="Images/Ep1_Thumbnail.jpg" alt="small image" class="no-filter" />
      </div>
    </div>
  </section>


  <br><br><br><br><br><br>

  <div class="popup-overlay" id="broadcastPopupOverlay">
      <div class="popup-content" id="broadcastPopupContent">
          <p id="popupMessage"></p>
      </div>
  </div>
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const hero = document.querySelector('.hero');
      const header = document.querySelector('header');
      const introCard = document.querySelector('.intro-card');
      const progressBar = document.getElementById('progressBar');
      const progressContainer = document.getElementById('progressContainer');
      const playPauseBtn = document.getElementById('playPauseBtn');
      const archiveItems = document.querySelectorAll('.archive-item');
      const archiveSection = document.querySelector('.archive-section');
      const archiveRow = document.querySelector('.archive-row');
      const progressTime = document.getElementById('progressTime');

      // Popup Elements
      const broadcastPopupOverlay = document.getElementById('broadcastPopupOverlay');
      const broadcastPopupContent = document.getElementById('broadcastPopupContent');
      const popupMessage = document.getElementById('popupMessage');

      let isPlaying = false;
      let isDragging = false;

      const colorPairs = [
          [240, 120],
          [240, 0],
          [220, 40],
          [310, 130],
          [330, 90, 210],
          [0, 60, 120],
          [10, 130, 250],
          [320, 0],
          [260, 300],
          [222, 69, 117],
          [219, 51, 102],
          [221, 64, 179],
          [0, 90, 180, 270],
          [0, 30],
          [330, 270],
          [300, 270],
          [330, 180, 120],
          [330, 90, 210],
          [350, 170],
          [340, 160],
          [320, 140],
          [0, 195],
          [0, 165],
          [0, 180],
          [0, 120],
          [0, 240],
          [240, 60],
          [270, 90],
          [240, -1],
          [240, -2],
          [285, 75],
          [320, 190],
          [350, 45],
          [5, 55],
          [224, 153],
          [224, 82],
          [219, 127],
          [222, 69],
      ];

      function isGreenHue(hue) {
        return hue >= 70 && hue <= 145;
      }

      function getRandomColorPair() {
        const randomIndex = Math.floor(Math.random() * colorPairs.length);
        return colorPairs[randomIndex];
      }

      const [hue1, hue2] = getRandomColorPair();
      const saturation = 70; // Saturation for direct HSL color
      const filterSaturation = 8000; // Saturation used in the filter %
      const lightness1 = Math.floor(Math.random() * 21) + 40; // Lightness for direct HSL color (40-60%)
      const lightness2 = Math.floor(Math.random() * 21) + 40; // Lightness for background HSL color (40-60%)

      // This 'color' will be used for text, progress bar, archive row bg, and popup background
      const color = `hsl(${hue1}, ${saturation}%, ${lightness1}%)`;
      // This 'bgColor' is for the main page background and popup text
      const bgColor = `hsl(${hue2}, ${saturation}%, ${lightness2}%)`;

      // Apply background color to body, hero, etc.
      document.body.style.backgroundColor = bgColor;
      hero.style.backgroundColor = bgColor;
      progressContainer.style.backgroundColor = bgColor;


      // Apply the main 'color' (from hue1) to the specified elements:
      // 1. Header text (including links within it)
      header.style.color = color;
      header.querySelectorAll('a').forEach(link => {
        link.style.color = color;
      });

      // 2. Progress bar background
      progressBar.style.backgroundColor = color;

      // 3. Archive row background
      if (archiveRow) {
        archiveRow.style.backgroundColor = color;
      }

      // 4. Popup background
      if (broadcastPopupContent) {
          broadcastPopupContent.style.backgroundColor = color;
      }


      // Apply the 'color' (from hue1) to the progress time display
      if (progressTime) {
        progressTime.style.color = color;
      }

      // Elements that should have colored FILTER (invert + hue rotate based on hue1)
      const elementsWithFilter = [
        introCard,
        playPauseBtn.querySelector('img')
      ];

      elementsWithFilter.forEach(el => {
        // Apply the simplified filter (no sepia)
        el.style.filter = `invert(1) saturate(${filterSaturation}%) hue-rotate(${hue1}deg)`;
      });

      // Elements that should have text color matching the page background (bgColor)
      const elementsWithText = [
        archiveSection, // Archive section border and non-row text
        ...archiveItems, // Archive item text (when expanded)
      ];

      elementsWithText.forEach(el => {
        // Make sure we don't override the archive row background we just set
        if (el !== archiveRow) {
             el.style.color = bgColor; // text color same as page background
        }
      });

       // Popup text color should match the page background (bgColor)
      if (popupMessage) {
          popupMessage.style.color = bgColor;
      }

      // Make sure "no-filter" images stay normal
      document.querySelectorAll('img.no-filter').forEach(img => {
        img.style.filter = 'none';
      });

      // Initial progress setup
      const initialProgress = 10;
      const audio = document.getElementById('audio');
      progressBar.style.width = `${initialProgress}%`;
      if (audio && !isNaN(audio.duration)) {
        // Set initial time only if audio metadata is loaded
        audio.onloadedmetadata = () => {
            audio.currentTime = (initialProgress / 100) * audio.duration;
            // Update time display initially too
            const initialMinutes = Math.floor(audio.currentTime / 60);
            const initialSeconds = Math.floor(audio.currentTime % 60);
            if(progressTime) {
                 progressTime.textContent = `${initialMinutes}:${initialSeconds < 10 ? '0' : ''}${initialSeconds}`;
            }
        };
         // Handle cases where metadata might already be loaded before listener attached
        if (audio.readyState >= 1) { // HAVE_METADATA or higher
             audio.currentTime = (initialProgress / 100) * audio.duration;
             const initialMinutes = Math.floor(audio.currentTime / 60);
             const initialSeconds = Math.floor(audio.currentTime % 60);
             if(progressTime) {
                 progressTime.textContent = `${initialMinutes}:${initialSeconds < 10 ? '0' : ''}${initialSeconds}`;
             }
        }
      }


      // Archive item expansion logic (remains the same)
      archiveSection.addEventListener('click', (event) => {
        // Ensure the click is directly on the section or row, not preventing default link behavior if links were added later
         if (event.target.closest('.archive-item') || event.target === archiveSection || event.target === archiveRow) {
              archiveItems.forEach(item => {
                  item.classList.toggle('expanded');
              });
          }
      });


      // --- AUDIO PLAYER LOGIC ---
      const audioPlayer = document.getElementById('audio');
      const buttonIcon = document.getElementById('buttonIcon');
      const broadcastDate = new Date(Date.UTC(2025, 4, 2, 14, 0, 0)); // Month is 0-indexed (4 for May)

      function showBroadcastNotReadyPopup() {
           popupMessage.textContent = "The pilot broadcast will be available to play on 2.5.2025 at 4pm EET.";
           broadcastPopupOverlay.classList.add('visible');
      }

      function hideBroadcastNotReadyPopup() {
           broadcastPopupOverlay.classList.remove('visible');
      }

      function togglePlayPause() {
          const now = new Date();

          if (now < broadcastDate) {
              // Broadcast is not yet available, show popup
              showBroadcastNotReadyPopup();
          } else {
              // Broadcast is available, proceed with play/pause
              if (audioPlayer.paused || audioPlayer.ended) {
                  audioPlayer.play();
                  buttonIcon.src = 'Images/OhRadio_Stop.svg'; // Change icon to Pause
                  isPlaying = true;
              } else {
                  audioPlayer.pause();
                  buttonIcon.src = 'Images/OhRadio_Play.svg'; // Change icon to Play
                  isPlaying = false;
              }
          }
      }

      playPauseBtn.addEventListener('click', togglePlayPause);

      // Hide popup when clicking on the overlay
      broadcastPopupOverlay.addEventListener('click', (event) => {
          if (event.target === broadcastPopupOverlay) { // Check if the click is directly on the overlay, not the content
              hideBroadcastNotReadyPopup();
          }
      });


      // Update progress bar and time as audio plays
      audioPlayer.addEventListener('timeupdate', () => {
          if (!isDragging && audioPlayer.duration) {
              const progressPercent = (audioPlayer.currentTime / audioPlayer.duration) * 100;
              progressBar.style.width = `${progressPercent}%`;

              // Update time display
              const currentMinutes = Math.floor(audioPlayer.currentTime / 60);
              const currentSeconds = Math.floor(audioPlayer.currentTime % 60);
              // const durationMinutes = Math.floor(audioPlayer.duration / 60); // Not currently displayed
              // const durationSeconds = Math.floor(audioPlayer.duration % 60); // Not currently displayed

               if(progressTime) {
                   progressTime.textContent = `${currentMinutes}:${currentSeconds < 10 ? '0' : ''}${currentSeconds}`;
               }
          }
      });

       // Allow seeking by clicking/dragging on the progress bar
       function seek(event) {
            if (audioPlayer.duration) {
                const containerRect = progressContainer.getBoundingClientRect();
                // Calculate click position relative to the progress bar *only*
                const clickX = event.clientX - progressBar.getBoundingClientRect().left; // Use progressBar rect
                const percentage = (clickX / progressBar.offsetWidth) * 100; // Use progressBar width

                // Clamp percentage between 0 and 100
                const clampedPercentage = Math.max(0, Math.min(100, percentage));

                const seekTime = (clampedPercentage / 100) * audioPlayer.duration;
                audioPlayer.currentTime = seekTime;
                progressBar.style.width = `${clampedPercentage}%`; // Update bar immediately
            }
        }

       progressContainer.addEventListener('mousedown', (e) => {
           // Only start dragging if the broadcast is available
           const now = new Date();
           if (now >= broadcastDate) {
                isDragging = true;
                seek(e); // Seek on initial click
           } else {
               // If broadcast is not available, clicking the progress bar does nothing
               // but the popup is handled by clicking the play button.
           }
       });

       document.addEventListener('mousemove', (e) => {
           if (isDragging) {
               seek(e);
           }
       });

       document.addEventListener('mouseup', () => {
           if (isDragging) {
               isDragging = false;
           }
       });


       // Reset to Play button when audio ends
       audioPlayer.addEventListener('ended', () => {
           buttonIcon.src = 'images/OhRadio_Play.svg';
           progressBar.style.width = '0%'; // Reset progress bar
           if(progressTime) progressTime.textContent = '0:00';
           isPlaying = false;
       });


      document.body.style.visibility = 'visible'; // Make body visible after styles are applied
    });

  </script>

</body>
</html>